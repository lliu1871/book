
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Chapter 6: Hypothesis testing &#8212; Statistical Inference in Bioinformatics</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 7: Multiple tests" href="chap7.html" />
    <link rel="prev" title="Chapter 5: Estimation theory" href="chap5.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Inference in Bioinformatics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Table of Contents
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Preface
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lecture
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="chap0.html">
   Chapter 0: Prerequisites
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap1.html">
   Chapter 1: Probability theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap2.html">
   Chapter 2: Discrete random variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap3.html">
   Chapter 3: Continuous random variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap4.html">
   Chapter 4: Multiple random variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap5.html">
   Chapter 5: Estimation theory
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Chapter 6: Hypothesis testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap7.html">
   Chapter 7: Multiple tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap8.html">
   Chapter 8: RNA-seq analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap9.html">
   Chapter 9: Linear regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap10.html">
   Chapter 10: Monte Carlo simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap11.html">
   Chapter 11: Bootstrap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap12.html">
   Chapter 12: Bayesian analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap13.html">
   Chapter 13: Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap14.html">
   Chapter 14: Substitution models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap15.html">
   Chapter 15: Phylogenetic models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lab
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lab1.html">
   Lab 1: Introduction to R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab2.html">
   Lab 2: Generating random numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab3.html">
   Lab 3: The law of large numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab4.html">
   Lab 4: BLAST
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab5.html">
   Lab 5: Optimization algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab6.html">
   Lab 6: Hypothesis testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab7.html">
   Lab 7: Multiple tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab8.html">
   Lab 8: RNA-seq analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab9.html">
   Lab 9: Linear regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab10.html">
   Lab 10: Monte Carlo simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab11.html">
   Lab 11: Bootstrap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab12.html">
   Lab 12: Markov Chain Monte Carlo algorithm
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab13.html">
   Lab 13: Markov chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab14.html">
   Lab 14: Substitution models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab15.html">
   Lab 15: Phylogenetic tree reconstruction
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/chap6.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchap6.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/chap6.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="_sources/chap6.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-principles-hypothesis-test-stat-decision">
   General principles (hypothesis, test stat, decision)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#type-i-and-ii-errors">
   Type I and II errors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluating-the-performance-of-a-test">
   Evaluating the performance of a test
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-sample-t-test">
   One sample t-test
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#one-sided-t-test">
     One-sided t-test
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-sided-t-test">
     Two-sided t-test
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-sample-t-test">
   Two sample t-test
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#one-sided-test">
     One-sided test
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-sided-test">
     Two-sided test
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#f-test-for-more-than-two-samples">
   F-test for more than two samples
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#association-test-contingency-table">
   Association test (contingency table):
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#likelihood-ratio-test">
   Likelihood ratio test
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-points-hypothesis">
     1. Two points hypothesis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-hypotheses-are-intervals">
     2. The hypotheses are intervals
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nested-hypotheses-the-null-hypothesis-is-nested-in-the-alternative-hypothesis">
     3. Nested hypotheses (the null hypothesis is nested in the alternative hypothesis)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mann-whitney-test-nonparametric-test-for-two-samples">
   Mann-Whitney test (nonparametric test for two samples)
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Chapter 6: Hypothesis testing</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-principles-hypothesis-test-stat-decision">
   General principles (hypothesis, test stat, decision)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#type-i-and-ii-errors">
   Type I and II errors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluating-the-performance-of-a-test">
   Evaluating the performance of a test
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-sample-t-test">
   One sample t-test
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#one-sided-t-test">
     One-sided t-test
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-sided-t-test">
     Two-sided t-test
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-sample-t-test">
   Two sample t-test
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#one-sided-test">
     One-sided test
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-sided-test">
     Two-sided test
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#f-test-for-more-than-two-samples">
   F-test for more than two samples
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#association-test-contingency-table">
   Association test (contingency table):
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#likelihood-ratio-test">
   Likelihood ratio test
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-points-hypothesis">
     1. Two points hypothesis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-hypotheses-are-intervals">
     2. The hypotheses are intervals
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nested-hypotheses-the-null-hypothesis-is-nested-in-the-alternative-hypothesis">
     3. Nested hypotheses (the null hypothesis is nested in the alternative hypothesis)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mann-whitney-test-nonparametric-test-for-two-samples">
   Mann-Whitney test (nonparametric test for two samples)
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-6-hypothesis-testing">
<h1>Chapter 6: Hypothesis testing<a class="headerlink" href="#chapter-6-hypothesis-testing" title="Permalink to this headline">#</a></h1>
<blockquote class="epigraph">
<div><p><em>“Do the difficult things while they are easy and do the great things while they are small. A journey of a thousand miles must begin with a single step.”</em></p>
<p class="attribution">—Lao Tzu</p>
</div></blockquote>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Statistical_hypothesis_testing">Statistical hypothesis testing</a></p></li>
</ul>
</div>
<p>We begin this chapter with an example of the two sample t-test. There are two pizza companies A and B. We have collected the data from a sample of deliveries of Company A and Company B.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{|l|l|l|l|l|l|l|l|}
\hline A &amp; 20.4 &amp; 24.2 &amp; 15.4 &amp; 21.4 &amp; 20.2 &amp; 19.3 &amp; 22.3 \\
\hline B &amp; 20.2 &amp; 16.9 &amp; 18.5 &amp; 17.3 &amp; 20.5 &amp; 20.3 &amp; 18.4 \\
\hline
\end{array}
\end{split}\]</div>
<p>The average delivery time for company A is 20.46, while it is 18.87 for company B. It seems that company B delivers pizza faster than company A. But this conclusion is based on a single sample. If we take another sample, the result may be different. We really want to know if company B indeed delivers pizza faster than company A?</p>
<p>Let <span class="math notranslate nohighlight">\(\mu_A\)</span> and <span class="math notranslate nohighlight">\(\mu_B\)</span> be the overall mean delivery time for company A and B respectively. By “company B delivers pizza faster than company A”, we mean that the overall average delivery time of company B is less than that of company A, i.e., <span class="math notranslate nohighlight">\(\mu_A &gt; \mu_B\)</span>. Hence, we have two hypotheses (the null hypothesis and the alternative hypothesis)</p>
<p><span class="math notranslate nohighlight">\(\mathrm{H}_{0}: \mu_{A}=\mu_{B}\)</span> vs <span class="math notranslate nohighlight">\(\mathrm{H}_{1}: \mu_{A} &gt; \mu_{B}\)</span></p>
<p>Test-stat: <span class="math notranslate nohighlight">\(t=\frac{\bar{x}_{A}-\bar{x}_{B}}{s d\left(\bar{x}_{A}-\bar{x}_{B}\right)}\)</span>.</p>
<p>Rejection region: we reject the null hypothesis <span class="math notranslate nohighlight">\(\mathrm{H}_{0}\)</span> if <span class="math notranslate nohighlight">\(t\)</span> is too large, i.e., <span class="math notranslate nohighlight">\(t&gt;a\)</span> where <span class="math notranslate nohighlight">\(a\)</span> is called the critical value for rejecting the null hypothesis.</p>
<section id="general-principles-hypothesis-test-stat-decision">
<h2>General principles (hypothesis, test stat, decision)<a class="headerlink" href="#general-principles-hypothesis-test-stat-decision" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>The null and alternative hypotheses must be about unknown parameters. They should NOT involve statistics.</p></li>
<li><p>If we reject the null hypothesis, we can say that the alternative hypothesis is true. But if we cannot reject the null hypothesis, we cannot say that the null hypothesis is true. We can only say that there is no enough information in the data to support either the null or the alternative hypothesis.</p></li>
<li><p>Because we cannot accept the null hypothesis, the scientifically significant hypothesis (or the hypothesis you want to conclude) should be formulated as the alternative hypothesis.</p></li>
<li><p>The test statistic should be a function of the estimators of parameters in the hypotheses.</p></li>
<li><p>The rejection region consists of values of test statistic for rejecting the null hypothesis.</p></li>
</ol>
<div class="proof example admonition" id="6.1">
<p class="admonition-title"><span>Example </span> (6.1)</p>
<section class="example-content" id="proof-content">
<p>A pharmaceutical company is testing if a new drug is effective. In this case, we should formulate the hypotheses as follows</p>
<p>H0: the drug is not effective</p>
<p>H1: the drug is effective</p>
<p>If we reject the null hypothesis, we can conclude that the drug is effective. However, if we switch the null and alternative hypothsis</p>
<p>H0: the drug is effective</p>
<p>H1: the drug is not effective</p>
<p>If we reject the null, we conclude that the drug is not effective. If we cannot reject the null, we still cannot accept the null hypothesis. Thus, we would NEVER conclude that the drug is effective if we formulate the null and alternative hypothese in this way.</p>
</section>
</div></section>
<section id="type-i-and-ii-errors">
<h2>Type I and II errors<a class="headerlink" href="#type-i-and-ii-errors" title="Permalink to this headline">#</a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>H0 is true</p></th>
<th class="head"><p>H1 is true</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Accept H0</p></td>
<td><p>-</p></td>
<td><p>Type II error</p></td>
</tr>
<tr class="row-odd"><td><p>Reject H0</p></td>
<td><p>Type I error</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<div class="proof definition admonition" id="Type I error">
<p class="admonition-title"><span>Definition </span> (Type I and II error)</p>
<section class="definition-content" id="proof-content">
<p>Type I error <span class="math notranslate nohighlight">\(=\mathrm{P}\left(\right.\)</span> rejection region <span class="math notranslate nohighlight">\(\left.\mid \mathrm{H}_{0}\right)\)</span></p>
<p>Type II error <span class="math notranslate nohighlight">\(=\mathrm{P}\left(\right.\)</span> acceptance region <span class="math notranslate nohighlight">\(\left.\mid \mathrm{H}_{1}\right)\)</span></p>
</section>
</div><p>Type I and II errors depend on the rejection region. Our goal is to minimize both types of errors. We may make Type I error arbitrarily small using trivial rejection regions.</p>
<p>For example, in the two sample <span class="math notranslate nohighlight">\(t\)</span> test, we reject the null if <span class="math notranslate nohighlight">\(t&gt;\infty\)</span> (this is the rejection region), then Type I error <span class="math notranslate nohighlight">\(=0\)</span>, because we never reject the null. But type II error <span class="math notranslate nohighlight">\(=1\)</span> for the same reason. If the rejection region is <span class="math notranslate nohighlight">\(t&gt;-\infty\)</span>, then Type I error <span class="math notranslate nohighlight">\(=1\)</span> and type II error <span class="math notranslate nohighlight">\(=0\)</span>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We can control Type I or Type II error separately, but we cannot control both errors simultaneously.</p>
</div>
<p>By convension, we choose to control type I error at the level of 5%. For example, the rejection region in the example of the two sample <span class="math notranslate nohighlight">\(t\)</span> test is <span class="math notranslate nohighlight">\(t&gt;a\)</span>. To control the type I error at the level of 5%, we have</p>
<div class="math notranslate nohighlight">
\[
P\left(t&gt;a \mid H_{0}\right)=0.05
\]</div>
<p>Solving this equation, we can find the critical value <span class="math notranslate nohighlight">\(a\)</span>. The solution is that <span class="math notranslate nohighlight">\(a\)</span> is the 95% quantile of the null distribution of the test statistic <span class="math notranslate nohighlight">\(t\)</span>.</p>
</section>
<section id="evaluating-the-performance-of-a-test">
<h2>Evaluating the performance of a test<a class="headerlink" href="#evaluating-the-performance-of-a-test" title="Permalink to this headline">#</a></h2>
<p>The performance of a test is evaluated by its power, which is defined as the probability of rejecting <span class="math notranslate nohighlight">\(H_{0}\)</span> while <span class="math notranslate nohighlight">\(H_{1}\)</span> is true, i.e.,</p>
<div class="math notranslate nohighlight">
\[
\text { Power }=P\left(\text { rejection region } \mid \mathrm{H}_{1}\right)=1 \text { - Type II error. }
\]</div>
<p>When the alternative hypothesis <span class="math notranslate nohighlight">\(\mathrm{H}_{1}\)</span> is an interval, the power of the test must be evaluated at each value in the interval of the parameters.</p>
</section>
<section id="one-sample-t-test">
<h2>One sample t-test<a class="headerlink" href="#one-sample-t-test" title="Permalink to this headline">#</a></h2>
<div class="admonition-assumption admonition">
<p class="admonition-title">Assumption</p>
<p>The one-sample t-test is used to determine if the population mean <span class="math notranslate nohighlight">\(\mu\)</span> is equal to a constant. The test assumes that the sample follows the normal distributions, i.e.,</p>
<div class="math notranslate nohighlight">
\[X_1,\dots,X_n \sim Normal(\mu, \sigma^2)\]</div>
</div>
<section id="one-sided-t-test">
<h3>One-sided t-test<a class="headerlink" href="#one-sided-t-test" title="Permalink to this headline">#</a></h3>
<p>Given a random sample <span class="math notranslate nohighlight">\(X_{1}, X_{2}, \ldots, X_{n} \sim \operatorname{Normal}\left(\mu, \sigma^{2}\right)\)</span>, we want to test if the population mean is <span class="math notranslate nohighlight">\(\mu=1\)</span> or <span class="math notranslate nohighlight">\(\mu&gt;1\)</span>. This is called the one-sided test. If the alternative hypothesis is <span class="math notranslate nohighlight">\(\mu\ne 1\)</span>, it is called the two-sided test.</p>
<div class="math notranslate nohighlight">
\[
\mathrm{H}_{0}: \mu=1 \text{ versus } \mathrm{H}_{1}: \mu&gt;1
\]</div>
<p>Test-stat: <span class="math notranslate nohighlight">\(t=\frac{\bar{x}-1} {sd(\bar{x})}\)</span>. The null distribution of <span class="math notranslate nohighlight">\(t\)</span> is the student <span class="math notranslate nohighlight">\(t\)</span> distribution with degrees of freedom <span class="math notranslate nohighlight">\((n-1)\)</span>.</p>
<p>Rejection region: we reject the null if <span class="math notranslate nohighlight">\(t&gt;a\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is the 95% quantile of the null distribution of the test statistic.</p>
<p>If the alternative is H1: <span class="math notranslate nohighlight">\(\mu&lt;1\)</span>, we only need to change the rejection region and we reject the null if <span class="math notranslate nohighlight">\(t&lt;a\)</span> where <span class="math notranslate nohighlight">\(a\)</span> is the 5% quantile of the null distribution of the test statistic.</p>
<p>Here, we use the rejection region to make decisions. Alternatively, we may calculate the pvalue and reject the null if <span class="math notranslate nohighlight">\(\text{pvalue}\le 0.05\)</span>. The pvalue is an estimate of the Type I error, defined as</p>
<div class="math notranslate nohighlight">
\[ pvalue = P(\text{rejection region} | H_0)\]</div>
<p>where the critical value <span class="math notranslate nohighlight">\(a\)</span> in the rejection region is replaced by the test statistic calculated from data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">20</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s">&quot;less&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	One Sample t-test

data:  data
t = -5.4438, df = 19, p-value = 1.49e-05
alternative hypothesis: true mean is less than 3
95 percent confidence interval:
     -Inf 2.247082
sample estimates:
mean of x 
 1.896603 
</pre></div>
</div>
</div>
</div>
</section>
<section id="two-sided-t-test">
<h3>Two-sided t-test<a class="headerlink" href="#two-sided-t-test" title="Permalink to this headline">#</a></h3>
<div class="math notranslate nohighlight">
\[
\mathrm{H}_{0}: \mu=1 \text{ versus } \mathrm{H}_{1}: \mu\ne 1
\]</div>
<p>Test-stat: <span class="math notranslate nohighlight">\(t=\frac{\bar{x}-1} {sd(\bar{x})}\)</span>. The null distribution of <span class="math notranslate nohighlight">\(t\)</span> is the student <span class="math notranslate nohighlight">\(t\)</span> distribution with degrees of freedom <span class="math notranslate nohighlight">\((n-1)\)</span>.</p>
<p>Rejection region: we reject the null if <span class="math notranslate nohighlight">\(t&gt;a\)</span> or <span class="math notranslate nohighlight">\(t&lt;b\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is the 97.5% quantile and <span class="math notranslate nohighlight">\(b\)</span> is the 2.5% quantile of the null distribution of the test statistic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">20</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s">&quot;two.sided&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	One Sample t-test

data:  data
t = -5.1449, df = 19, p-value = 5.758e-05
alternative hypothesis: true mean is not equal to 3
95 percent confidence interval:
 1.378344 2.316225
sample estimates:
mean of x 
 1.847285 
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="two-sample-t-test">
<h2>Two sample t-test<a class="headerlink" href="#two-sample-t-test" title="Permalink to this headline">#</a></h2>
<div class="admonition-assumption admonition">
<p class="admonition-title">Assumption</p>
<p>The two-sample t-test is used to determine if two population means <span class="math notranslate nohighlight">\(\mu_1\)</span> and <span class="math notranslate nohighlight">\(\mu_2\)</span> are equal. The test assumes that the two samples follow the normal distributions, i.e.,</p>
<div class="math notranslate nohighlight">
\[X_1,\dots,X_n \sim Normal(\mu_1, \sigma^2)\]</div>
<div class="math notranslate nohighlight">
\[Y_1,\dots,Y_m \sim Normal(\mu_2, \sigma^2)\]</div>
</div>
<section id="one-sided-test">
<h3>One-sided test<a class="headerlink" href="#one-sided-test" title="Permalink to this headline">#</a></h3>
<p>The test is one-sided if the alternative hypothesis is one-sided.</p>
<div class="math notranslate nohighlight">
\[
H_0: \mu_1 = \mu_2 \text{ versus } H_1: \mu_1 &gt; \mu_2
\]</div>
<p>Test-stat: <span class="math notranslate nohighlight">\(t= \frac{\bar{X_{1}} - \bar{X_{2}}}{\sqrt{{s^{2}_{1}}/n_{1} + {s^{2}_{2}}/n_{2}}}\)</span>, where <span class="math notranslate nohighlight">\(n_1\)</span> and <span class="math notranslate nohighlight">\(n_2\)</span> are the sample sizes, <span class="math notranslate nohighlight">\(\bar{X}_1\)</span> and <span class="math notranslate nohighlight">\(\bar{X}_2\)</span> are the sample means, and <span class="math notranslate nohighlight">\(s^2_1\)</span> and <span class="math notranslate nohighlight">\(s_2^2\)</span> are the sample variances.</p>
<p>Rejection region: we reject the null if the test statistic is too large, i.e., <span class="math notranslate nohighlight">\(t&gt;a\)</span> where the critical value <span class="math notranslate nohighlight">\(a\)</span> is the 95% quantile of the t distribution with <span class="math notranslate nohighlight">\(n_1+n_2-2\)</span> degrees of freedom.</p>
<div class="math notranslate nohighlight">
\[
H_0: \mu_1 = \mu_2 \text{ versus } H_1: \mu_1 &lt; \mu_2
\]</div>
<p>Test-stat: the same</p>
<p>Rejection region: we reject the null if the test statistic is <span class="math notranslate nohighlight">\(t&lt;a\)</span> where the critical value <span class="math notranslate nohighlight">\(a\)</span> is the 5% quantile of the t distribution with <span class="math notranslate nohighlight">\(n_1+n_2-2\)</span> degrees of freedom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">group1</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">20</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
<span class="n">group2</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">20</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="m">3</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
<span class="nf">boxplot</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span><span class="n">group2</span><span class="p">))</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s">&quot;greater&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Welch Two Sample t-test

data:  group1 and group2
t = -2.8896, df = 31.508, p-value = 0.9965
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 -1.44786      Inf
sample estimates:
mean of x mean of y 
 2.101888  3.014514 
</pre></div>
</div>
<img alt="_images/chap6_5_1.png" src="_images/chap6_5_1.png" />
</div>
</div>
</section>
<section id="two-sided-test">
<h3>Two-sided test<a class="headerlink" href="#two-sided-test" title="Permalink to this headline">#</a></h3>
<div class="math notranslate nohighlight">
\[
H_0: \mu_1 = \mu_2 \text{ versus } H_1: \mu_1 \ne \mu_2
\]</div>
<p>Test-stat: the same</p>
<p>Rejection region: we reject the null if the test statistic is <span class="math notranslate nohighlight">\(t&lt;a\)</span> or <span class="math notranslate nohighlight">\(t&gt;b\)</span> where the critical values <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are the 97.5% and 2.5% quantile of the t distribution with <span class="math notranslate nohighlight">\(n_1+n_2-2\)</span> degrees of freedom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">t.test</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s">&quot;two.sided&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Welch Two Sample t-test

data:  group1 and group2
t = -2.8896, df = 31.508, p-value = 0.006925
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1.5563502 -0.2689017
sample estimates:
mean of x mean of y 
 2.101888  3.014514 
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="f-test-for-more-than-two-samples">
<h2>F-test for more than two samples<a class="headerlink" href="#f-test-for-more-than-two-samples" title="Permalink to this headline">#</a></h2>
<div class="admonition-assumption admonition">
<p class="admonition-title">Assumption</p>
<p>The F-test (ANOVA) can determine whether multiple population means <span class="math notranslate nohighlight">\(\mu_1,\dots,\mu_k\)</span> are equal. The test assumes that the samples follow the normal distributions, i.e.,</p>
<div class="math notranslate nohighlight">
\[X_{11},\dots,X_{1n_1} \sim Normal(\mu_1, \sigma^2)\]</div>
<div class="math notranslate nohighlight">
\[X_{21},\dots,X_{2n_2} \sim Normal(\mu_2, \sigma^2)\]</div>
<p>…</p>
<div class="math notranslate nohighlight">
\[X_{k1},\dots,X_{kn_k} \sim Normal(\mu_k, \sigma^2)\]</div>
</div>
<div class="math notranslate nohighlight">
\[ H_0: \mu_1 = \dots = \mu_k \text{ versus } H_1: \text{at least two means are not equal}\]</div>
<p>Test-stat: <span class="math notranslate nohighlight">\(t\)</span> = variation between sample means / variation within the samples</p>
<p>Rejection region: We reject the null if <span class="math notranslate nohighlight">\(t&gt;a\)</span> where <span class="math notranslate nohighlight">\(a\)</span> is the 95% quantile of the F distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">group1</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">20</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
<span class="n">group2</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">20</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="m">3.2</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
<span class="n">group3</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">20</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="m">4</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span><span class="n">group2</span><span class="p">,</span><span class="n">group3</span><span class="p">)</span>
<span class="n">group</span><span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s">&quot;group1&quot;</span><span class="p">,</span><span class="m">20</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="s">&quot;group2&quot;</span><span class="p">,</span><span class="m">20</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="s">&quot;group3&quot;</span><span class="p">,</span><span class="m">20</span><span class="p">))</span>
<span class="nf">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">~</span><span class="n">group</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="nf">aov</span><span class="p">(</span><span class="n">data</span><span class="o">~</span><span class="n">group</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
group        2  26.79  13.395    16.1 2.87e-06 ***
Residuals   57  47.43   0.832                     
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</pre></div>
</div>
<img alt="_images/chap6_9_1.png" src="_images/chap6_9_1.png" />
</div>
</div>
</section>
<section id="association-test-contingency-table">
<h2>Association test (contingency table):<a class="headerlink" href="#association-test-contingency-table" title="Permalink to this headline">#</a></h2>
<div class="admonition-assumption admonition">
<p class="admonition-title">Assumption</p>
<p>The association test can determine whether there is association between two variables, for instance, smoking and gender. The test assumes that the counts follow the Poisson distribution.</p>
</div>
<p>We randomly take 20 people (12 female and 8 male) and count the number of people who smoke. We want to know if smoking is associated with gender.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{|l|l|l|l|}
\hline &amp; smoking &amp; non-smoking &amp; total \\
\hline male &amp; 6(3.6) &amp; 2(4.4) &amp; 8 \\
\hline female &amp; 3(5.4) &amp; 9(6.6) &amp; 12 \\
\hline total &amp; 9 &amp; 11 &amp; 20 \\
\hline
\end{array}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(H_0\)</span> : gender and smoking are independent versus <span class="math notranslate nohighlight">\(H_1\)</span> : not independent</p>
<p>If the null hypothesis is true, then <span class="math notranslate nohighlight">\(P(M\cap S)=P(M) * P(S)=8 / 20 * 9 / 20\)</span>. Thus, under the null hypothesis, the expected number of male who smoke is <span class="math notranslate nohighlight">\(8 / 20 * 9 / 20 * 20=3.6\)</span>. Similarly, the expected number of female who smoke is <span class="math notranslate nohighlight">\(12 / 20 * 9 / 20 * 20=5.4\)</span>. The expected number of male who do not smoke is <span class="math notranslate nohighlight">\(8 / 20 * 11 / 20 * 20=4.4\)</span>. The expected number of female who do not smoke is <span class="math notranslate nohighlight">\(12 / 20 * 11 / 20 * 20=6.6\)</span>.</p>
<p>Test-stat: <span class="math notranslate nohighlight">\(t=\sum_{i=1}^{4} \frac{\left(o_{i}-e_{i}\right)^{2}}{e_{i}}\)</span>.</p>
<p>The null distribution of the test statistic is asymptotically (sample size is large) the chi-square distribution with <span class="math notranslate nohighlight">\((r-1)(c-1)\)</span> degrees of freedom, in which <span class="math notranslate nohighlight">\(r\)</span> is the number of rows and <span class="math notranslate nohighlight">\(c\)</span> is the number of columns.</p>
<p>Rejection region: we reject the null if <span class="math notranslate nohighlight">\(t&gt;a\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is the 95% quantile of the chi-square distribution with <span class="math notranslate nohighlight">\((r-1)(c-1)\)</span> degrees of freedom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">9</span><span class="p">),</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">)</span>
<span class="n">contingency_table</span> <span class="o">=</span> <span class="nf">as.table</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="nf">chisq.test</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span>
<span class="n">result</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;the expected count is &quot;</span><span class="p">,</span><span class="n">result</span><span class="o">$</span><span class="n">expected</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in chisq.test(contingency_table):
&quot;Chi-squared approximation may be incorrect&quot;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Pearson&#39;s Chi-squared test with Yates&#39; continuity correction

data:  contingency_table
X-squared = 3.0387, df = 1, p-value = 0.0813
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;the expected count is  3.6&quot; &quot;the expected count is  5.4&quot;
[3] &quot;the expected count is  4.4&quot; &quot;the expected count is  6.6&quot;
</pre></div>
</div>
</div>
</div>
</section>
<section id="likelihood-ratio-test">
<h2>Likelihood ratio test<a class="headerlink" href="#likelihood-ratio-test" title="Permalink to this headline">#</a></h2>
<div class="admonition-assumption admonition">
<p class="admonition-title">Assumption</p>
<p>The likelihood ratio test can test which hypothesis (null or alternative) has a better fit to the real data. The test assumes that the likelihood function is given.</p>
</div>
<section id="two-points-hypothesis">
<h3>1. Two points hypothesis<a class="headerlink" href="#two-points-hypothesis" title="Permalink to this headline">#</a></h3>
<p><span class="math notranslate nohighlight">\(\mathrm{H}_{0}: \theta=\theta_{0}\)</span> vs <span class="math notranslate nohighlight">\(\mathrm{H}_{1}: \theta=\theta_{1}\)</span></p>
<p>Test-stat: <span class="math notranslate nohighlight">\(t=\frac{l_{0}}{l_{1}}\)</span>, or equivalently, <span class="math notranslate nohighlight">\(t=2 \log \left(l_{1}\right)-2 \log \left(l_{0}\right)\)</span>, where <span class="math notranslate nohighlight">\(l_{0}\)</span> is the likelihood under the null hypothesis and <span class="math notranslate nohighlight">\(l_{1}\)</span> is the likelihood under the alternative hypothesis.</p>
<p>Rejection region: we reject the null if <span class="math notranslate nohighlight">\(t&gt;a\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is the 95% quantile of the null distribution of the test statistic.</p>
<div class="proof example admonition" id="6.2">
<p class="admonition-title"><span>Example </span> (6.2)</p>
<section class="example-content" id="proof-content">
<p>Given a random sample <span class="math notranslate nohighlight">\(X_{1}, X_{2}, \ldots, X_{n} \sim \operatorname{Normal}\left(\mu, \sigma^{2}=1\right)\)</span>, we want to test if <span class="math notranslate nohighlight">\(\mu=1\)</span> or <span class="math notranslate nohighlight">\(\mu=2\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathrm{H}_{0}: u=1 \text { vs } \mathrm{H}_{1}: u=2 \\\end{split}\]</div>
<p>We first find the likelihood score <span class="math notranslate nohighlight">\(l_0\)</span> for the null hypothesis</p>
<div class="math notranslate nohighlight">
\[
\begin{gathered}
l_{0}=\prod_{i=1}^{n} \frac{1}{\sqrt{2 \pi \sigma^{2}}} e^{-\frac{\left(x_{i}-\mu\right)^{2}}{2 \sigma^{2}}}=\prod_{i=1}^{n} \frac{1}{\sqrt{2 \pi}} e^{-\frac{\left(x_{i}-1\right)^{2}}{2}}
\end{gathered}
\]</div>
<p>and the likelihood score <span class="math notranslate nohighlight">\(l_1\)</span> for the alternative hypothesis</p>
<div class="math notranslate nohighlight">
\[
l_{1}=\prod_{i=1}^{n} \frac{1}{\sqrt{2 \pi}} e^{-\frac{\left(x_{i}-2\right)^{2}}{2}}
\]</div>
<p>The test statistic is given by</p>
<div class="math notranslate nohighlight">
\[
t=2 \log \left(l_{1}\right)-2 \log \left(l_{0}\right)=\frac{-2 \sum_{i=1}^{n} x_{i}+3 n}{2}=-\sum_{i=1}^{n} x_{i}+\frac{3 n}{2}
\]</div>
<p>The null distribution of <span class="math notranslate nohighlight">\(t\)</span> is normal with mean <span class="math notranslate nohighlight">\(-n \mu+\frac{3 n}{2}\)</span> and variance <span class="math notranslate nohighlight">\(n \sigma^{2}\)</span>.</p>
<p>Rejection region: we reject the null if <span class="math notranslate nohighlight">\(t&gt;a\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is the 95% quantile of the null distribution of the test statistic <span class="math notranslate nohighlight">\(t\)</span>.</p>
</section>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="n">mean</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">sd</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="n">loglike0</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="nf">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mean</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">sd</span><span class="o">=</span><span class="m">1</span><span class="p">)))</span>
<span class="n">loglike1</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="nf">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mean</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="n">sd</span><span class="o">=</span><span class="m">1</span><span class="p">)))</span>
<span class="n">t</span> <span class="o">=</span> <span class="m">2</span><span class="o">*</span><span class="n">loglike1</span> <span class="o">-</span> <span class="m">2</span><span class="o">*</span><span class="n">loglike0</span>
<span class="n">a</span> <span class="o">=</span> <span class="nf">qchisq</span><span class="p">(</span><span class="m">0.95</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;the test statistic is&quot;</span><span class="p">,</span><span class="n">t</span><span class="p">,</span> <span class="s">&quot;and the critical value a =&quot;</span><span class="p">,</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;the test statistic is -31.4368699656314 and the critical value a = 3.84145882069412&quot;
</pre></div>
</div>
</div>
</div>
<div class="proof lemma admonition" id="lemma-3">
<p class="admonition-title"><span class="caption-number">Lemma 1 </span> (Neyman-Pearson lemma)</p>
<section class="lemma-content" id="proof-content">
<p>The likelihood ratio test for two simple hypotheses is the most powerful test.</p>
</section>
</div></section>
<section id="the-hypotheses-are-intervals">
<h3>2. The hypotheses are intervals<a class="headerlink" href="#the-hypotheses-are-intervals" title="Permalink to this headline">#</a></h3>
<p><span class="math notranslate nohighlight">\(\mathrm{H}_{0}: \theta \in \Theta_{0}\)</span> vs <span class="math notranslate nohighlight">\(\mathrm{H}_{1}: \theta \in \Theta_{1}\)</span></p>
<p>Test-stat: <span class="math notranslate nohighlight">\(t=2 \log \left(l_{1}\right)-2 \log \left(l_{0}\right)\)</span>, where <span class="math notranslate nohighlight">\(l_{0}=\max _{\theta \in \Theta_{0}}\{l(\theta)\}\)</span> is the maximum likelihood score under the null hypothesis and <span class="math notranslate nohighlight">\(l_{1}\)</span> is the maximum likelihood score <span class="math notranslate nohighlight">\(l_{1}=\)</span> <span class="math notranslate nohighlight">\(\max _{\theta \in \Theta_{1}}\{l(\theta)\}\)</span> under the alternative hypothesis.</p>
<p>Rejection region: we reject the null if <span class="math notranslate nohighlight">\(t&gt;a\)</span> where <span class="math notranslate nohighlight">\(a\)</span> is the 95% quantile of the null distribution of the test statistic.</p>
</section>
<section id="nested-hypotheses-the-null-hypothesis-is-nested-in-the-alternative-hypothesis">
<h3>3. Nested hypotheses (the null hypothesis is nested in the alternative hypothesis)<a class="headerlink" href="#nested-hypotheses-the-null-hypothesis-is-nested-in-the-alternative-hypothesis" title="Permalink to this headline">#</a></h3>
<p><span class="math notranslate nohighlight">\(\mathrm{H}_{0}: \mathrm{M}_{0}\)</span> vs <span class="math notranslate nohighlight">\(\mathrm{H}_{1}: \mathrm{M}_{1}\)</span></p>
<p>Test-stat: <span class="math notranslate nohighlight">\(t=2 \log \left(l_{1}\right)-2 \log \left(l_{0}\right)\)</span>, where <span class="math notranslate nohighlight">\(l_{0}=\max _{\theta \in \mathrm{M}_{0}}\{l(\theta)\}\)</span> is the maximum likelihood score under the null hypothesis and <span class="math notranslate nohighlight">\(l_{1}\)</span> is the maximum likelihood score <span class="math notranslate nohighlight">\(l_{1}=\)</span> <span class="math notranslate nohighlight">\(\max _{\theta \in \mathrm{M}_{1}}\{l(\theta)\}\)</span> under the alternative hypothesis.</p>
<p>The null distribution of the test statistic is asymptotically the chi-square distribution with <span class="math notranslate nohighlight">\(\mathrm{df}=\left(\right.\)</span> number of free parameters in <span class="math notranslate nohighlight">\(\mathrm{H}_{1}-\)</span> number of free parameters in <span class="math notranslate nohighlight">\(\left.\mathrm{H}_{0}\right)\)</span></p>
<p>Rejection region: we reject the null if <span class="math notranslate nohighlight">\(t&gt;a\)</span> where <span class="math notranslate nohighlight">\(a\)</span> is the 95% quantile of the chi-square distribution</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="n">mean</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">sd</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="n">loglike0</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="nf">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mean</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span><span class="n">sd</span><span class="o">=</span><span class="m">1</span><span class="p">)))</span>
<span class="n">loglike1</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="nf">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mean</span><span class="o">=</span><span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">sd</span><span class="o">=</span><span class="m">1</span><span class="p">)))</span>
<span class="n">t</span> <span class="o">=</span> <span class="m">2</span><span class="o">*</span><span class="n">loglike1</span> <span class="o">-</span> <span class="m">2</span><span class="o">*</span><span class="n">loglike0</span>
<span class="n">a</span> <span class="o">=</span> <span class="nf">qchisq</span><span class="p">(</span><span class="m">0.95</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;the test statistic is&quot;</span><span class="p">,</span><span class="n">t</span><span class="p">,</span> <span class="s">&quot;and the critical value a =&quot;</span><span class="p">,</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;the test statistic is 17.20619071751 and the critical value a = 3.84145882069412&quot;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="mann-whitney-test-nonparametric-test-for-two-samples">
<h2>Mann-Whitney test (nonparametric test for two samples)<a class="headerlink" href="#mann-whitney-test-nonparametric-test-for-two-samples" title="Permalink to this headline">#</a></h2>
<div class="admonition-assumption admonition">
<p class="admonition-title">Assumption</p>
<p>The Mann-Whitney test can test if two populations have the same median. The test does not assume any underlying probability distribution. This is a nonparametric test.</p>
</div>
<p>The data consist of two random samples. Let <span class="math notranslate nohighlight">\(X_{1}, \dots, X_{n}\)</span> be the sample generated from population 1 and <span class="math notranslate nohighlight">\(Y_{1}, \dots, Y_{m}\)</span> be the sample from population 2. We want to test if two samples are from the same population, i.e.,</p>
<div class="math notranslate nohighlight">
\[
\mathrm{H}_{0}: pop1 = pop2 \text{  versus } \mathrm{H}_{1}: \text{pop1 not equal pop2}
\]</div>
<p>Test-stat: Ranking all observations from the minimum to the maximum. If several sample values are exactly equal to each other (tied), assign to each the average rank. Let <span class="math notranslate nohighlight">\(\mathrm{R}\left(\mathrm{X}_{\mathrm{i}}\right)\)</span> denote the ranks of <span class="math notranslate nohighlight">\(\mathrm{X}_{\mathrm{i}}\)</span>. The test statistic is <span class="math notranslate nohighlight">\(T=\sum_{i=1}^{n} R\left(X_{i}\right)\)</span>.</p>
<p>Under the null hypothesis that two samples are generated from the same population, the ranks of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are totally random. Thus, the ranks of <span class="math notranslate nohighlight">\(X\)</span> (assuming no ties) are <span class="math notranslate nohighlight">\(n\)</span> numbers chosen at random without replacement from <span class="math notranslate nohighlight">\((1,2, \ldots, n+m)\)</span>. The null distribution of <span class="math notranslate nohighlight">\(\mathrm{T}\)</span> can be derived for small <span class="math notranslate nohighlight">\(\mathrm{n}\)</span> and <span class="math notranslate nohighlight">\(\mathrm{m}\)</span> (table). For large <span class="math notranslate nohighlight">\(\mathrm{n}\)</span> and <span class="math notranslate nohighlight">\(\mathrm{m}\)</span>, we can use simulation to calculate the null distribution of <span class="math notranslate nohighlight">\(T\)</span>.</p>
<p>Rejection region: we reject the null hypothesis if <span class="math notranslate nohighlight">\(t&gt;a\)</span> or <span class="math notranslate nohighlight">\(t&lt;b\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is the 97.5% quantile of the null distribution of the test statistic, and <span class="math notranslate nohighlight">\(b\)</span> is the 2.5% quantile of the null distribution of the test statistic.</p>
<div class="proof example admonition" id="6.3">
<p class="admonition-title"><span>Example </span> (6.3)</p>
<section class="example-content" id="proof-content">
<p>Data is given in the table</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{|l|l|l|l|l|l|}
\hline X &amp; 2.3(5) &amp; 1.4(1) &amp; 1.6(3) &amp; 1.8(4) &amp; \\
\hline Y &amp; 1.5(2) &amp; 3.7(9) &amp; 3.2(7) &amp; 2.8(6) &amp; 3.3(8) \\
\hline
\end{array}
\end{split}\]</div>
<p>Test-stat: Let <span class="math notranslate nohighlight">\(R_i\)</span> be the sum of the ranks in group <span class="math notranslate nohighlight">\(i\)</span>. Define <span class="math notranslate nohighlight">\(U_i=n_1n_2+\frac{n_i(n_i+1)}{2}-R_i\)</span>. The test statistic is the smaller of <span class="math notranslate nohighlight">\(U_1\)</span> and <span class="math notranslate nohighlight">\(U_2\)</span>.</p>
<p>Rejection region: we reject the null hypothesis if <span class="math notranslate nohighlight">\(t&gt;a\)</span> or <span class="math notranslate nohighlight">\(t&lt;b\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is the 97.5% quantile of the null distribution of the test statistic, and <span class="math notranslate nohighlight">\(b\)</span> is the 2.5% quantile of the null distribution of the test statistic.</p>
</section>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2.3</span><span class="p">,</span><span class="m">1.4</span><span class="p">,</span><span class="m">1.6</span><span class="p">,</span><span class="m">1.8</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1.5</span><span class="p">,</span><span class="m">3.7</span><span class="p">,</span><span class="m">3.2</span><span class="p">,</span><span class="m">2.8</span><span class="p">,</span><span class="m">3.3</span><span class="p">)</span>
<span class="nf">wilcox.test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Wilcoxon rank sum exact test

data:  x and y
W = 3, p-value = 0.1111
alternative hypothesis: true location shift is not equal to 0
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="chap5.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Chapter 5: Estimation theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="chap7.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 7: Multiple tests</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Liang Liu<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>